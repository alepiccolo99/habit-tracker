<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Life Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="sidebar" class="sidebar">
        <div class="profile-section">
            <div class="avatar">AP</div>
            <div class="name">Alessandro Piccolo</div>
            <div class="username">@alepiccolo99</div>
        </div>
        <nav>
            <button onclick="router('habits')" class="nav-btn active">Habits</button>
            <button onclick="router('health')" class="nav-btn">Health</button>
            <button onclick="router('workout')" class="nav-btn">Workout</button>
            <button onclick="router('diet')" class="nav-btn">Diet</button>
            <button onclick="router('settings')" class="nav-btn">Settings</button>
        </nav>
    </div>
    <div id="overlay" onclick="toggleSidebar()"></div>

    <div class="main-container">
        
        <header id="main-header">
            <button id="menuBtn" onclick="toggleSidebar()">☰</button>
            <h1 id="page-title">Habits</h1>
            <button id="headerActionBtn" class="action-btn" onclick="openAddModal()">+</button>
        </header>

        <section id="habits-view" class="view active-view">
            <div id="habits-container">
                <div id="habits-week-header" class="habit-grid-header">
                    </div>
                <div id="habits-list">
                    <div style="text-align:center; margin-top:50px; color:var(--text-secondary)">Loading...</div>
                </div>
            </div>
        </section>

        <section id="habit-detail-view" class="view">
            <div class="detail-header">
                <button class="back-btn" onclick="router('habits')">←</button>
                <h1 id="detail-title">Reading</h1>
            </div>

            <div class="stats-row">
                <div class="stat-box">
                    <div class="stat-val" id="stat-streak">0</div>
                    <div class="stat-label">Streak</div>
                </div>
                <div class="stat-box">
                    <div class="stat-val" id="stat-rate">0%</div>
                    <div class="stat-label">Month Rate</div>
                </div>
                <div class="stat-box">
                    <div class="stat-val" id="stat-total">0</div>
                    <div class="stat-label">Check-ins</div>
                </div>
            </div>

            <div class="card">
                <h3 id="cal-month-name">Calendar</h3>
                <div id="calendar-grid" class="calendar-grid"></div>
            </div>

            <div class="card">
                <h3>Consistency (Last 90 Days)</h3>
                <div id="heatmap-grid" class="heatmap-container"></div>
            </div>

            <div class="card">
                <h3>Goal Settings</h3>
                <div class="log-item">
                    <div>Frequency</div>
                    <div id="detail-freq" style="color:var(--text-secondary)">Daily</div>
                </div>
                <div class="log-item">
                    <div>Target</div>
                    <div id="detail-target" style="color:var(--text-secondary)">1/day</div>
                </div>
            </div>
        </section>

        <section id="settings-view" class="view">
            <div class="card">
                <h3>App Theme</h3>
                <div class="color-grid">
                    <div class="color-opt" style="background:#0a84ff" onclick="setTheme('#0a84ff')"></div> <div class="color-opt" style="background:#30d158" onclick="setTheme('#30d158')"></div> <div class="color-opt" style="background:#ff453a" onclick="setTheme('#ff453a')"></div> <div class="color-opt" style="background:#ff9f0a" onclick="setTheme('#ff9f0a')"></div> <div class="color-opt" style="background:#bf5af2" onclick="setTheme('#bf5af2')"></div> <div class="color-opt" style="background:#98989d" onclick="setTheme('#98989d')"></div> </div>
            </div>
        </section>

        <section id="health-view" class="view">
            <div class="card">
                <h3>Add Metric</h3>
                <select id="healthType">
                    <option value="Weight">Weight (kg)</option>
                    <option value="Sleep">Sleep (hrs)</option>
                    <option value="Stress">Stress (1-10)</option>
                </select>
                <input type="number" id="healthValue" placeholder="Value">
                <button class="btn-primary" onclick="handleAddMetric()">Save</button>
            </div>
            <div id="health-list" class="log-list"></div>
        </section>

        <section id="workout-view" class="view">
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('workout', 'log')">Log</button>
                <button class="tab-btn" onclick="switchTab('workout', 'db')">Exercises</button>
            </div>
            <div id="workout-log-tab" class="tab-content active">
                <div class="card">
                     <select id="woExercise"><option>Loading...</option></select>
                     <div style="display:flex; gap:10px"><input id="woKg" placeholder="Kg"><input id="woReps" placeholder="Reps"></div>
                     <button class="btn-primary" onclick="handleLogWorkout()">Log Set</button>
                </div>
                <div id="workout-history" class="log-list"></div>
            </div>
            <div id="workout-db-tab" class="tab-content">
                <div class="card">
                    <input id="exName" placeholder="Exercise Name">
                    <button class="btn-primary" onclick="handleAddExercise()">Add to DB</button>
                </div>
            </div>
        </section>

        <section id="diet-view" class="view">
             <div class="card">
                <h3>Quick Add</h3>
                <select id="dietFood"><option>Loading...</option></select>
                <input id="dietQty" placeholder="Quantity">
                <button class="btn-primary" onclick="handleLogFood()">Eat</button>
             </div>
             <div id="diet-history" class="log-list"></div>
        </section>

    </div>

    <dialog id="addHabitModal" style="background:var(--bg-card); color:white; border:none; border-radius:16px; padding:20px; width:80%;">
        <h3>New Habit</h3>
        <input id="newHabitName" placeholder="Habit Name">
        <select id="newHabitFreq">
            <option value="Daily">Daily</option>
            <option value="Weekly">Weekly</option>
        </select>
        <div style="display:flex; gap:10px; margin-top:10px">
            <button class="btn-primary" style="background:var(--bg-input); color:var(--text-primary)" onclick="document.getElementById('addHabitModal').close()">Cancel</button>
            <button class="btn-primary" onclick="submitNewHabit()">Save</button>
        </div>
    </dialog>

    <script src="app.js"></script>
</body>
</html>
